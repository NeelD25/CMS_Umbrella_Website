<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Static HTML Generator (SEO Focus)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            font-family: 'Inter', sans-serif;
        }
        /* Simple scrollbar styling */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f5f9;
        }
        ::-webkit-scrollbar-thumb {
            background: #94a3b8;
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #64748b;
        }

        /* Main layout: 1/3 for editor, 2/3 for preview */
        .editor-container {
            display: grid;
            grid-template-columns: 1fr 2fr;
            height: 100vh;
        }
        /* On smaller screens, stack them */
        @media (max-width: 1024px) {
            .editor-container {
                grid-template-columns: 1fr;
            }
            .preview-panel-container {
                display: none; /* Hide live preview on mobile, rely on button */
            }
        }
        .editor-panel {
            background-color: #f8fafc;
            padding: 24px;
            overflow-y: auto;
            border-right: 1px solid #e2e8f0;
        }
        .preview-panel-container {
            position: relative;
            background-color: #ffffff;
            height: 100vh; /* Full height for the iframe container */
        }
        #preview-iframe {
            width: 100%;
            height: 100%;
            border: none;
            background-color: white;
        }
        .floating-controls {
            position: sticky;
            top: 0;
            z-index: 10;
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(8px);
            padding: 12px 24px;
            border-bottom: 1px solid #e2e8f0;
            display: flex;
            justify-content: flex-end;
            gap: 12px;
            /* Added for wrapping controls on smaller screens */
            flex-wrap: wrap; 
        }
        .form-section {
            background-color: white;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 24px;
            border: 1px solid #e5e7eb;
            box-shadow: 0 1px 3px 0 rgb(0 0 0 / 0.05);
        }
        .job-card {
            border: 1px solid #e5e7eb;
            padding: 16px;
            border-radius: 8px;
            margin-bottom: 16px;
            background-color: #f9fafb;
        }
        .input-field {
            margin-top: 4px;
            display: block;
            width: 100%;
            border-radius: 6px;
            border: 1px solid #d1d5db;
            padding: 8px 12px;
            font-size: 14px;
        }
        .input-field:focus {
            outline: 2px solid #3b82f6;
            outline-offset: 2px;
            border-color: #3b82f6;
        }
        label {
            font-size: 14px;
            font-weight: 500;
            color: #374151;
        }
    </style>
</head>
<body class="bg-gray-50">
    <div class="editor-container">
        <div class="editor-panel">
            <h2 class="text-3xl font-bold mb-6 text-gray-800 border-b pb-4">Static Page Content</h2>

            <div class="form-section">
                <h3 class="text-xl font-semibold mb-4 text-gray-700">Header Content</h3>
                <div class="space-y-4">
                    <div>
                        <label for="headerTitle">Main Title</label>
                        <input type="text" id="headerTitle" class="input-field" value="Indian Government Jobs Portal - Latest Sarkari Naukri">
                    </div>
                    <div>
                        <label for="headerSubtitle">Subtitle (Used in Header)</label>
                        <input type="text" id="headerSubtitle" class="input-field" value="Your Desk for Government Jobs, Admit Cards & Results">
                    </div>
                </div>
            </div>

            <div class="form-section">
                <h3 class="text-xl font-semibold mb-4 text-gray-700">SEO & Meta Tags (Paste HTML Here) ðŸš€</h3>
                <label for="metaTagsContent">Paste your `<meta>`, `<link>`, or other `<head>` HTML tags here (e.g., description, keywords, viewport, canonical).</label>
                <textarea id="metaTagsContent" rows="8" class="input-field font-mono text-xs mt-2" placeholder='<meta name="description" content="Your detailed page description...">
<meta name="keywords" content="job, naukri, sarkari, government">
<meta name="author" content="Your Site Name">
<link rel="canonical" href="https://yoursite.com/">'></textarea>
            </div>
            <div class="form-section">
                <h3 class="text-xl font-semibold mb-4 text-gray-700">AdSense Code Snippets</h3>
                <div class="space-y-4">
                     <div>
                        <label for="adsenseTop">Ad Code (Top of Page)</label>
                        <textarea id="adsenseTop" rows="4" class="input-field font-mono text-xs" placeholder=""></textarea>
                     </div>
                     <div>
                        <label for="adsenseBottom">Additional Ad Code (Below Blog)</label>
                        <textarea id="adsenseBottom" rows="4" class="input-field font-mono text-xs" placeholder=""></textarea>
                    </div>
                </div>
            </div>

            <div class="form-section">
                <h3 class="text-xl font-semibold mb-4 text-gray-700">Job Entries Table</h3>
                <button id="addJobBtn" class="w-full bg-green-600 text-white p-3 rounded-lg hover:bg-green-700 transition-colors duration-200 mb-4 font-bold flex items-center justify-center gap-2">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 5a1 1 0 011 1v3h3a1 1 0 110 2h-3v3a1 1 0 11-2 0v-3H6a1 1 0 110-2h3V6a1 1 0 011-1z" clip-rule="evenodd" /></svg>
                    <span>Add New Job Entry</span>
                </button>
                <div id="jobListContainer">
                    </div>
            </div>

            <div class="form-section">
                <h3 class="text-xl font-semibold mb-4 text-gray-700">Main Blog Content</h3>
                <label for="mainBlogContent">Paste your pure HTML content below. It will appear under the job table.</label>
                <textarea id="mainBlogContent" rows="15" class="input-field font-mono text-sm mt-2" placeholder="<p>Start your detailed blog post here...</p><h2>Subheading</h2><p>More content...</p>"></textarea>
            </div>

            <div class="form-section">
                <h3 class="text-xl font-semibold mb-4 text-gray-700">Custom Footer HTML</h3>
                <label for="footerHtmlContent">Edit the footer HTML directly.</label>
                <textarea id="footerHtmlContent" rows="15" class="input-field font-mono text-sm mt-2"><footer style="all: initial; display: block; width: 100%; text-align: center; padding: 15px 10px; background-color: #2c3e50; color: #ffffff; font-family: Arial, Helvetica, sans-serif; font-size: 14px; box-sizing: border-box;">
  <p style="all: unset; display: inline; color: #ffffff;">
    &copy; 2025 <strong>Rozgardesk</strong>. All rights reserved. 
    <a href='../privacypolicy.html' style='all: unset; color:#ffffff; cursor:pointer; text-decoration:none; font-weight:500;' onmouseover='this.style.textDecoration="underline";' onmouseout='this.style.textDecoration="none";'>
      Privacy Policy
    </a> |
    <a href='../aboutus.html' style='all: unset; color:#ffffff; cursor:pointer; text-decoration:none; font-weight:500;' onmouseover='this.style.textDecoration="underline";' onmouseout='this.style.textDecoration="none";'>
      About Us
    </a>
  </p>
</footer></textarea>
            </div>
        </div>

        <div class="preview-panel-container">
            <div class="floating-controls">
                
                <button id="downloadConfigBtn" class="bg-yellow-500 text-gray-900 py-2 px-4 rounded-lg hover:bg-yellow-600 transition-colors duration-200 font-semibold flex items-center gap-2">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-5 h-5"><path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5m-13.5-9L12 3m0 0 4.5 4.5M12 3v13.5" /></svg>
                    <span>Download Edits</span>
                </button>
                <label for="restoreFile" class="bg-yellow-500 text-gray-900 py-2 px-4 rounded-lg hover:bg-yellow-600 transition-colors duration-200 font-semibold flex items-center gap-2 cursor-pointer">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-5 h-5"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625A3.375 3.375 0 0 0 16.125 8.25h-2.25M20.25 10.5h-8.25m0 0L14.25 7.5m-2.25 3L14.25 13.5" /><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625A3.375 3.375 0 0 0 16.125 8.25h-2.25m0 0H12v6.75A2.25 2.25 0 0 1 9.75 17.25H4.5M7.5 7.5h.008v.008H7.5V7.5Zm2.25 0h.008v.008h-.008V7.5Z" /></svg>
                    <span>Restore Config</span>
                </label>
                <input type="file" id="restoreFile" accept=".json" class="hidden">
                <button id="saveConfigBtn" class="bg-indigo-600 text-white py-2 px-4 rounded-lg hover:bg-indigo-700 transition-colors duration-200 font-semibold flex items-center gap-2">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-5 h-5"><path stroke-linecap="round" stroke-linejoin="round" d="M16.5 3.75V16.5M16.5 3.75H13.5M16.5 3.75L7.5 12m9 0v6.75m0-6.75H7.5M7.5 12v6.75M7.5 12L3 7.5m4.5 4.5l4.5 4.5m-4.5-4.5H3m18-6.75v-2.25A2.25 2.25 0 0 0 18.75 3h-2.25m0 0H15M3 18.75v-2.25M3 18.75h2.25A2.25 2.25 0 0 0 7.5 16.5m0 0H9m9-4.5v-2.25A2.25 2.25 0 0 0 16.5 9h-2.25M18.75 9H21m-2.25 0v6.75m-6-6.75h-2.25m0 0H12" /></svg>
                    <span>Save Config</span>
                </button>
                <button id="previewBtn" class="bg-gray-700 text-white py-2 px-4 rounded-lg hover:bg-gray-800 transition-colors duration-200 font-semibold flex items-center gap-2">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-5 h-5"><path stroke-linecap="round" stroke-linejoin="round" d="M2.036 12.322a1.012 1.012 0 0 1 0-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.43-.0.639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178Z" /><path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z" /></svg>
                    <span>Update Preview</span>
                </button>
                <button id="downloadBtn" class="bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 transition-colors duration-200 font-semibold flex items-center gap-2">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-5 h-5"><path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3" /></svg>
                    <span>Download Pure HTML</span>
                </button>
            </div>
            <iframe id="preview-iframe"></iframe>
        </div>
    </div>

    <script>
        // NOTE: This script is ONLY for the generator tool's functionality.
        // It is NOT included in the final downloaded HTML file.

        const USER_CONFIG_KEY = 'staticPageConfig'; // Key for localStorage

        const userStyles = `
            * { margin: 0; padding: 0; box-sizing: border-box; }
            body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: #f5f7fa; color: #333; line-height: 1.6; }
            .container { max-width: 1600px; margin: 0 auto; padding: 20px; }
            .header { background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%); color: white; padding: 40px 20px; text-align: center; margin-bottom: 12px; /* REDUCED GAP */ border-radius: 10px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
            .header h1 { font-size: 2.8rem; margin-bottom: 10px; font-weight: 300; }
            .header p { font-size: 1.2rem; opacity: 0.9; }
            .main-content { display: flex; flex-direction: column; gap: 12px; /* REDUCED GAP */ }
            .stats { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; }
            .stat-card { background: white; padding: 25px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.05); text-align: center; border: 1px solid #e5e7eb; }
            .stat-value { font-size: 2.2rem; font-weight: 700; color: #3498db; }
            .stat-label { font-size: 1rem; color: #7f8c8d; margin-top: 5px; }
            .job-table-container { overflow-x: auto; background: white; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.05); border: 1px solid #e5e7eb; }
            .job-table { width: 100%; border-collapse: collapse; }
            .job-table th, .job-table td { padding: 15px; text-align: left; border-bottom: 1px solid #ecf0f1; }
            .job-table th { background-color: #f9fafb; font-weight: 600; color: #4b5563; text-transform: uppercase; font-size: 0.8rem; letter-spacing: 0.5px;}
            .job-table tr:last-child td { border-bottom: none; }
            .job-table tr:hover { background-color: #f5f7fa; }
            .view-details-btn { background-color: #3498db; color: white; padding: 8px 16px; border: none; border-radius: 6px; cursor: pointer; text-decoration: none; display: inline-block; font-size: 0.9rem; transition: background-color 0.2s; }
            .view-details-btn:hover { background-color: #2980b9; }
            .blog-section {
                            padding: 20px 24px;
                            background: white;
                            border-radius: 8px;
                            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
                            border: 1px solid #e5e7eb;
                            width: 100%;
                            max-width: 1600px;
                            margin: 0 auto;
                            }

            .blog-section h2 { font-size: 1.8rem; font-weight: 700; color: #34495e; margin-bottom: 20px; border-bottom: 2px solid #3498db; padding-bottom: 10px; }
            .faq-section { margin-top: 20px; }
            .faq-item { margin-bottom: 15px; padding: 20px; background-color: #ffffff; border-left: 4px solid #3498db; border-radius: 4px; box-shadow: 0 2px 4px rgba(0,0,0,0.05); border: 1px solid #e5e7eb; }
            .faq-item p { margin: 0; }
            .faq-item p:first-child { font-weight: bold; color: #34495e; margin-bottom: 8px; }
            .footer { background: #34495e; color: #bdc3c7; text-align: center; padding: 25px 0; font-size: 0.95rem; margin-top: 40px; }
            .footer a { color: white; text-decoration: none; margin: 0 10px; transition: text-decoration 0.2s; }
            .footer a:hover { text-decoration: underline; }

            /* Add styles to ensure the table handles the extra columns without breaking */
            @media (min-width: 1200px) {
                 .job-table th, .job-table td {
                    /* Adjust padding for more columns if needed, keeping it readable */
                    padding: 12px 10px; 
                    font-size: 0.95rem; 
                }
                .job-table-container {
                    /* Allow for wider table if necessary */
                    overflow-x: auto; 
                }
            }


            @media (max-width: 768px) {
                .header h1 { font-size: 2.2rem; }
            }
        `;

        let jobsData = [
            // UPDATED: Added location, qualification, and ageLimit to the default job objects
            { id: "job1", title: "SSC CPO Notification 2025", department: "SSC", location: "All India", posts: 4187, lastDate: "2025-10-28", qualification: "Any Graduate", ageLimit: "20 - 25 yrs", blogPost: "blog/ssc-cpo-2025.html" },
            { id: "job2", title: "Bihar Police SI Recruitment", department: "Police", location: "Bihar", posts: 1275, lastDate: "2025-11-05", qualification: "Any Graduate", ageLimit: "20 - 37 yrs", blogPost: "blog/bihar-si-2025.html" },
            { id: "job3", title: "UPSSSC Junior Engineer (JE)", department: "State Gov.", location: "Uttar Pradesh", posts: 1477, lastDate: "2025-10-07", qualification: "Diploma/B.E/B.Tech", ageLimit: "18 - 40 yrs", blogPost: "blog/upsssc-je-2025.html" },
        ];

        const jobListContainer = document.getElementById('jobListContainer');
        const addJobBtn = document.getElementById('addJobBtn');
        const previewBtn = document.getElementById('previewBtn');
        const downloadBtn = document.getElementById('downloadBtn');
        const saveConfigBtn = document.getElementById('saveConfigBtn'); 
        const downloadConfigBtn = document.getElementById('downloadConfigBtn'); // NEW
        const restoreFileInput = document.getElementById('restoreFile'); // NEW
        const iframe = document.getElementById('preview-iframe');

        const formFields = [
            'headerTitle', 'headerSubtitle', 'metaTagsContent', 'adsenseTop', 'adsenseBottom', 
            'mainBlogContent', 'footerHtmlContent'
        ];

        function formatDate(dateString) {
            if (!dateString) return 'N/A';
            const date = new Date(dateString);
            // Check if date is valid
            if (isNaN(date)) {
                 // Attempt to parse if it's already a formatted string like '18 Oct 2025'
                return dateString; 
            }
            const options = { day: '2-digit', month: 'short', year: 'numeric' };
            return date.toLocaleDateString('en-IN', options);
        }

        // --- PERSISTENCE LOGIC ---

        function getConfigObject() {
             const config = {};
            // 1. Get all input/textarea values
            formFields.forEach(id => {
                config[id] = document.getElementById(id).value;
            });
            
            // 2. Get the jobsData array
            config.jobsData = jobsData;
            return config;
        }

        function setConfigObject(config) {
             // 1. Load all input/textarea values
            formFields.forEach(id => {
                const element = document.getElementById(id);
                if (element && config[id] !== undefined) {
                    element.value = config[id];
                }
            });

            // 2. Load the jobsData array
            if (config.jobsData && Array.isArray(config.jobsData)) {
                jobsData = config.jobsData;
                // Add default values for new fields if old data is loaded
                 jobsData.forEach(job => {
                    if (!job.location) job.location = "N/A";
                    if (!job.qualification) job.qualification = "N/A";
                    if (!job.ageLimit) job.ageLimit = "N/A";
                });
            }
        }


        function saveConfig(silent = false) {
            const config = getConfigObject();
            
            try {
                localStorage.setItem(USER_CONFIG_KEY, JSON.stringify(config));
                if (!silent) {
                    alert('Configuration saved successfully! Changes will persist on next load. âœ…');
                }
            } catch (e) {
                console.error("Could not save configuration to Local Storage:", e);
                if (!silent) {
                    alert('Error: Could not save configuration. Check browser console.');
                }
            }
        }

        function loadConfig() {
            try {
                const savedConfig = localStorage.getItem(USER_CONFIG_KEY);
                if (savedConfig) {
                    const config = JSON.parse(savedConfig);
                    setConfigObject(config);
                    console.log('Configuration loaded from Local Storage.');
                    return true;
                }
            } catch (e) {
                console.error("Could not load configuration from Local Storage:", e);
                // On error, falls back to default jobsData and form values
            }
            return false;
        }
        
        // NEW: Downloads the current config as a JSON file
        function downloadEdits() {
            const config = getConfigObject();
            const dataStr = "data:text/json;charset=utf-8," + encodeURIComponent(JSON.stringify(config, null, 2));
            const downloadAnchorNode = document.createElement('a');
            downloadAnchorNode.setAttribute("href", dataStr);
            downloadAnchorNode.setAttribute("download", "static_page_config.json");
            document.body.appendChild(downloadAnchorNode);
            downloadAnchorNode.click();
            document.body.removeChild(downloadAnchorNode);
        }

        // NEW: Restores config from an uploaded JSON file
        function restoreConfig(event) {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = (e) => {
                try {
                    const config = JSON.parse(e.target.result);
                    setConfigObject(config);
                    renderJobEditor();
                    iframe.srcdoc = generateStaticHtml();
                    alert('Configuration restored successfully from file! Please click "Save Config" to save it to your browser.');
                } catch (error) {
                    alert('Error loading file: Invalid JSON format.');
                    console.error("Restore error:", error);
                }
                event.target.value = ''; // Clear file input
            };
            reader.readAsText(file);
        }

        // --- UI RENDERING LOGIC ---

        function renderJobEditor() {
            jobListContainer.innerHTML = '';
            jobsData.forEach((job) => {
                const card = document.createElement('div');
                card.className = 'job-card';
                card.innerHTML = `
                    <div class="flex justify-between items-start">
                        <h4 id="job-title-${job.id}" class="text-md font-semibold text-gray-800 mb-3 pr-2">${job.title}</h4>
                        <button data-id="${job.id}" class="delete-btn text-red-500 hover:text-red-700 transition-colors p-1 rounded-full">
                           <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z" clip-rule="evenodd" /></svg>
                        </button>
                    </div>
                    <div class="space-y-3">
                        <div><label>Title</label><input type="text" data-id="${job.id}" data-field="title" value="${job.title}" class="input-field"></div>
                        <div><label>Department</label><input type="text" data-id="${job.id}" data-field="department" value="${job.department}" class="input-field"></div>
                        
                        <div><label>Location</label><input type="text" data-id="${job.id}" data-field="location" value="${job.location}" class="input-field"></div>
                        <div><label>Qualification</label><input type="text" data-id="${job.id}" data-field="qualification" value="${job.qualification}" class="input-field"></div>
                        <div><label>Age Limit</label><input type="text" data-id="${job.id}" data-field="ageLimit" value="${job.ageLimit}" class="input-field"></div>
                        <div><label>Posts</label><input type="number" data-id="${job.id}" data-field="posts" value="${job.posts}" class="input-field"></div>
                        <div><label>Last Date</label><input type="date" data-id="${job.id}" data-field="lastDate" value="${job.lastDate}" class="input-field"></div>
                        <div><label>Blog Post Link (e.g., blog/file.html)</label><input type="text" data-id="${job.id}" data-field="blogPost" value="${job.blogPost}" class="input-field"></div>
                    </div>
                `;
                jobListContainer.appendChild(card);
            });
            attachInputListeners();
        }

        function attachInputListeners() {
            // Re-attach listeners for all form elements and newly rendered job inputs
            document.querySelectorAll('.input-field, textarea').forEach(input => {
                input.removeEventListener('input', handleInputChange); // Remove old listener to prevent duplicates
                input.addEventListener('input', handleInputChange);
            });

            document.querySelectorAll('.delete-btn').forEach(btn => {
                btn.removeEventListener('click', handleDeleteClick); // Remove old listener
                btn.addEventListener('click', handleDeleteClick);
            });
            
            // Re-attach listener for the file input
            restoreFileInput.removeEventListener('change', restoreConfig);
            restoreFileInput.addEventListener('change', restoreConfig);
        }
        
        function handleInputChange(e) {
            const id = e.target.getAttribute('data-id');
            if (id) { // This is a job field
                const field = e.target.getAttribute('data-field');
                const job = jobsData.find(j => j.id === id);
                if (job) {
                   job[field] = (e.target.type === 'number') ? parseInt(e.target.value) || 0 : e.target.value;
                   if (field === 'title') {
                        document.getElementById(`job-title-${id}`).textContent = e.target.value;
                   }
                }
            }
        }

        function handleDeleteClick(e) {
            const id = e.currentTarget.getAttribute('data-id');
            jobsData = jobsData.filter(job => job.id !== id);
            renderJobEditor();
        }

        addJobBtn.addEventListener('click', () => {
            const newId = "job" + Date.now();
            const newJob = {
                id: newId,
                title: "New Job Title", department: "Department", location: "Location", qualification: "N/A", ageLimit: "N/A", posts: 100,
                lastDate: new Date().toISOString().split('T')[0],
                blogPost: "blog/new-post.html"
            };
            jobsData.unshift(newJob); // unshift adds the new job to the beginning of the array
            renderJobEditor();
        });

        // --- PURE HTML GENERATION LOGIC ---

        function generateStaticHtml() {
            const headerTitle = document.getElementById('headerTitle').value;
            const headerSubtitle = document.getElementById('headerSubtitle').value;
            const metaTagsContent = document.getElementById('metaTagsContent').value; // Get the new content
            const adsenseTop = document.getElementById('adsenseTop').value;
            const adsenseBottom = document.getElementById('adsenseBottom').value;
            const mainBlogContent = document.getElementById('mainBlogContent').value;
            const footerHtmlContent = document.getElementById('footerHtmlContent').value;
            
            // UPDATED: Added location, qualification, and ageLimit fields to the rows
            const jobRows = jobsData.map(job => `
                <tr>
                    <td data-label="Title">${job.title}</td>
                    <td data-label="Department">${job.department}</td>
                    <td data-label="Location">${job.location}</td>
                    <td data-label="Posts">${job.posts.toLocaleString()}</td>
                    <td data-label="Qualification">${job.qualification}</td>
                    <td data-label="Age Limit">${job.ageLimit}</td>
                    <td data-label="Last Date">${formatDate(job.lastDate)}</td>
                    <td data-label="Action"><a href="${job.blogPost}" class="view-details-btn">View Details</a></td>
                </tr>
            `).join('');
            
            const totalPosts = jobsData.reduce((sum, job) => sum + job.posts, 0);

            return `<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>${headerTitle}</title>
    
    ${metaTagsContent}

    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8289629651403348"
            crossorigin="anonymous"><\/script>

    ${adsenseTop}
    <style>
        ${userStyles}
    </style>
</head>
<body>
    <header class="header">
        <h1>${headerTitle}</h1>
        <p>${headerSubtitle}</p>
    </header>

    <!-- *TOP Buttons* -->

    <div style="margin: 1px auto; text-align: center;">
  <a href="../latest-govt-jobs-admit-cards" style="display: inline-block; background-color: #007bff; color: #ffffff; text-decoration: none; padding: 10px 50px; margin: 6px; border-radius: 6px; font-weight: 500; transition: background-color 0.3s;">
    Admit Cards
  </a>

   <!-- *End Buttons* -->

    <div class="container">
        <main class="main-content">
            <section class="stats">
                <div class="stat-card">
                    <div class="stat-value">${jobsData.length}</div>
                    <div class="stat-label">Total Jobs Listed</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">${totalPosts.toLocaleString()}</div>
                    <div class="stat-label">Total Vacancies</div>
                </div>
            </section>

            <section class="job-table-container">
                <table class="job-table">
                    <thead>
                        <tr>
                            <th>Title</th>
                            <th>Department</th>
                            <th>Location</th>
                            <th>Posts</th>
                            <th>Qualification</th>
                            <th>Age Limit</th>
                            <th>Last Date</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody>${jobRows}</tbody>
                </table>
            </section>
            
            ${mainBlogContent ? `<section class="blog-section">${mainBlogContent}</section>` : ''}
            
            ${adsenseBottom}

            </main>
    </div>
    
    ${footerHtmlContent}

</body>
</html>`;
        }
        
        previewBtn.addEventListener('click', () => {
            iframe.srcdoc = generateStaticHtml();
        });

        saveConfigBtn.addEventListener('click', () => saveConfig(false)); 
        
        // NEW: Event listener for Download Edits button
        downloadConfigBtn.addEventListener('click', downloadEdits); 
        
        // NEW: Event listener for Restore Config file input is now attached in attachInputListeners and onload

        downloadBtn.addEventListener('click', () => {
            const staticHtml = generateStaticHtml();
            const blob = new Blob([staticHtml], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'index.html';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        });

        // --- INITIALIZATION ---
        document.addEventListener('DOMContentLoaded', () => {
            loadConfig(); // Load saved config first
            renderJobEditor();
            attachInputListeners(); // Attach listeners for form fields and the new restore input
            // Generate an initial preview when the page loads
            iframe.srcdoc = generateStaticHtml();
        });
    </script>
</body>
</html>